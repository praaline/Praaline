#include <QString>
#include <QFile>
#include <QTextStream>
#include "phonemedatabase.h"

PhonemeDatabase::PhonemeDatabase()
{
    m_phonemes << "eu" << "oe" << "oe~" << "@" << "E" << "H" << "O" << "R" << "S" << "Z" << "a"
               << "a~" << "b" << "d" << "e" << "e~" << "f" << "g" << "i" << "j" << "k" << "l"
               << "m" << "n" << "o" << "o~" << "p" << "s" << "t" << "u" << "v" << "w" << "y" << "z"
               << "J" << "N" << "tS" << "dZ";
    m_phonemes << "sil";
}

PhonemeDatabase::~PhonemeDatabase()
{

}

bool PhonemeDatabase::createHMMDefsBootstrap(const QString &filename)
{
    QFile fileHMMDEFS(filename);
    if ( !fileHMMDEFS.open( QIODevice::ReadWrite | QIODevice::Text ) ) return false;
    QTextStream hmmdefs(&fileHMMDEFS);
    hmmdefs.setCodec("ISO 8859-1");

    foreach (QString phoneme, m_phonemes) {
        hmmdefs << QString("~h \"%1\"\n").arg(phoneme);
        hmmdefs << "<BEGINHMM>\n";
        hmmdefs << "<NUMSTATES> 5\n";
        hmmdefs << "<STATE> 2\n";
        hmmdefs << "<MEAN> 25\n";
        hmmdefs << " 2.495273e-07 1.105371e-07 2.588544e-08 -3.083722e-08 -4.340004e-08 -4.191975e-08 2.943552e-08 3.052282e-09 1.035418e-07 6.766110e-08 1.671550e-08 -7.776114e-08 -7.355643e-03 -3.789790e-03 1.184971e-02 -7.089294e-03 -3.233539e-04 4.847068e-03 -5.158428e-03 6.903479e-04 9.217368e-03 -6.614285e-03 -1.175333e-03 1.114921e-02 4.575740e-03\n";
        hmmdefs << "<VARIANCE> 25\n";
        hmmdefs << " 6.580434e+01 3.732679e+01 3.525512e+01 4.770427e+01 4.332327e+01 4.544643e+01 5.620688e+01 2.553866e+01 4.001570e+01 3.416673e+01 2.128212e+01 2.660224e+01 1.668585e+00 1.700366e+00 1.616409e+00 1.768895e+00 1.718035e+00 2.098122e+00 2.326025e+00 1.677738e+00 2.010740e+00 1.595870e+00 1.417547e+00 1.510511e+00 1.447709e+00\n";
        hmmdefs << "<GCONST> 9.662931e+01\n";
        hmmdefs << "<STATE> 3\n";
        hmmdefs << "<MEAN> 25\n";
        hmmdefs << " 2.495273e-07 1.105371e-07 2.588544e-08 -3.083722e-08 -4.340004e-08 -4.191975e-08 2.943552e-08 3.052282e-09 1.035418e-07 6.766110e-08 1.671550e-08 -7.776114e-08 -7.355643e-03 -3.789790e-03 1.184971e-02 -7.089294e-03 -3.233539e-04 4.847068e-03 -5.158428e-03 6.903479e-04 9.217368e-03 -6.614285e-03 -1.175333e-03 1.114921e-02 4.575740e-03\n";
        hmmdefs << "<VARIANCE> 25\n";
        hmmdefs << " 6.580434e+01 3.732679e+01 3.525512e+01 4.770427e+01 4.332327e+01 4.544643e+01 5.620688e+01 2.553866e+01 4.001570e+01 3.416673e+01 2.128212e+01 2.660224e+01 1.668585e+00 1.700366e+00 1.616409e+00 1.768895e+00 1.718035e+00 2.098122e+00 2.326025e+00 1.677738e+00 2.010740e+00 1.595870e+00 1.417547e+00 1.510511e+00 1.447709e+00\n";
        hmmdefs << "<GCONST> 9.662931e+01\n";
        hmmdefs << "<STATE> 4\n";
        hmmdefs << "<MEAN> 25\n";
        hmmdefs << " 2.495273e-07 1.105371e-07 2.588544e-08 -3.083722e-08 -4.340004e-08 -4.191975e-08 2.943552e-08 3.052282e-09 1.035418e-07 6.766110e-08 1.671550e-08 -7.776114e-08 -7.355643e-03 -3.789790e-03 1.184971e-02 -7.089294e-03 -3.233539e-04 4.847068e-03 -5.158428e-03 6.903479e-04 9.217368e-03 -6.614285e-03 -1.175333e-03 1.114921e-02 4.575740e-03\n";
        hmmdefs << "<VARIANCE> 25\n";
        hmmdefs << " 6.580434e+01 3.732679e+01 3.525512e+01 4.770427e+01 4.332327e+01 4.544643e+01 5.620688e+01 2.553866e+01 4.001570e+01 3.416673e+01 2.128212e+01 2.660224e+01 1.668585e+00 1.700366e+00 1.616409e+00 1.768895e+00 1.718035e+00 2.098122e+00 2.326025e+00 1.677738e+00 2.010740e+00 1.595870e+00 1.417547e+00 1.510511e+00 1.447709e+00\n";
        hmmdefs << "<GCONST> 9.662931e+01\n";
        hmmdefs << "<TRANSP> 5\n";
        hmmdefs << " 0.000000e+00 1.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n";
        hmmdefs << " 0.000000e+00 6.000000e-01 4.000000e-01 0.000000e+00 0.000000e+00\n";
        hmmdefs << " 0.000000e+00 0.000000e+00 6.000000e-01 4.000000e-01 0.000000e+00\n";
        hmmdefs << " 0.000000e+00 0.000000e+00 0.000000e+00 7.000000e-01 3.000000e-01\n";
        hmmdefs << " 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n";
        hmmdefs << "<ENDHMM>\n";
    }

    fileHMMDEFS.close();
    return true;
}
